{% extends 'base.html' %}

{% load crispy_forms_tags %}

{% block title %}{{ post.title }}{% endblock %}

{% block body %}

    {{ comment }}
    <div class="col-sm-8 col-sm-offset-2">
        <p>{{ comment.content }}</p>
        <footer>
            via {{ comment.user }} | <cite title="">{{ comment.created_at|timesince }} ago</cite>
            {% if comment.children.count > 0 %}
                | {{ comment.children|length }}
                | {{ comment.children|length|pluralize:"comment,comments" }}
            {% endif %}

            {% if request.user == comment.user %}
                | <a href="{{ comment.get_delete_url }}">Delete</a>
            {% endif %}
        </footer>
        <hr/>

        <div>
            {% for reply in comment.children %}
                <blockquote>
                    <p>{{ reply.content }}</p>
                    <footer>
                        via {{ reply.user }} | <cite title="">{{ reply.created_at|timesince }} ago</cite>
                        {% if request.user == comment.user %}
                            | <a href="{{ child_comment.get_delete_url }}">Delete</a>
                        {% endif %}
                    </footer>
                </blockquote>
            {% endfor %}

            <form method="POST" action=".">{% csrf_token %}
                {{ form|crispy }}
                <input type="hidden" name="parent_id" value="{{ comment.id }}">
                <input type="submit" value="Reply" class="btn btn-default">
            </form>
        </div>
        <hr/>
    </div>
{% endblock %}